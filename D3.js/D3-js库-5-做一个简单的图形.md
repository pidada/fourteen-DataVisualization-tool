---
title: D3.jsåº“-5-åšä¸€ä¸ªç®€å•çš„å›¾å½¢
top: false
cover: false
toc: true
mathjax: true
copyright: true
date: 2020-05-15 11:36:33
password:
summary:
tags:
  - rect
categories:
  - datavisual
  - D3.js
---

### D3.jsåº“-5-åšä¸€ä¸ªç®€å•çš„å›¾å½¢

æœ¬æ–‡ä¸­ä»‹ç»åˆ©ç”¨ä¸€ç»„ç®€å•çš„æ•°æ®åˆ¶ä½œä¸€ä¸ªæ¡å½¢å›¾ï¼Œå…ˆçœ‹æ•ˆæœï¼š

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gesxnd1kzuj308v04h741.jpg)

<!--MORE-->

### ç”»å¸ƒ

åœ¨`HTML`ä¸­ä½¿ç”¨çš„ç”»å¸ƒæœ‰ä¸¤ç§ï¼š`SVG`å’Œ`Canvas`ï¼Œåœ¨`D3`ä¸­ä½¿ç”¨çš„æ˜¯`SVG`ã€‚

#### SVG

**SVGï¼ŒæŒ‡å¯ç¼©æ”¾çŸ¢é‡å›¾å½¢ï¼ˆScalable Vector Graphicsï¼‰ï¼Œæ˜¯ç”¨äºæè¿°äºŒç»´çŸ¢é‡å›¾å½¢çš„ä¸€ç§å›¾å½¢æ ¼å¼ï¼Œæ˜¯ç”±ä¸‡ç»´ç½‘è”ç›Ÿåˆ¶å®šçš„å¼€æ”¾æ ‡å‡†**ã€‚ SVG ä½¿ç”¨ XML æ ¼å¼æ¥å®šä¹‰å›¾å½¢ã€‚SVGçš„å‡ ä¸ªç‰¹ç‚¹

- SVGç»˜åˆ¶çš„æ˜¯çŸ¢é‡å›¾ï¼Œå¯¹å›¾åƒè¿›è¡Œæ”¾å¤§åä¸ä¼šå¤±çœŸ

- åŸºäºXMLï¼Œå¯ä»¥ä¸ºæ¯ä¸ªå…ƒç´ æ·»åŠ JSäº‹ä»¶çš„å¤„ç†

- æ¯ä¸ªå›¾å½¢æ˜¯å¯¹è±¡ï¼Œæ›´æ”¹å¯¹è±¡çš„å±æ€§ï¼Œå›¾å½¢ä¹Ÿä¼šæ”¹å˜

#### Canvas

**Canvas æ˜¯é€šè¿‡ JavaScript æ¥ç»˜åˆ¶ 2D å›¾å½¢ï¼Œæ˜¯ HTML 5 ä¸­æ–°å¢çš„å…ƒç´ **ï¼ŒCanvasçš„å‡ ä¸ªç‰¹ç‚¹

1. ç»˜åˆ¶çš„æ˜¯ä½å›¾ï¼Œæ”¾å¤§åå›¾å½¢ä¼šå¤±çœŸ

2. ä¸æ”¯æŒJSäº‹ä»¶å¤„ç†å™¨

3. èƒ½å¤Ÿä»¥`.png`æˆ–è€…`.jpg`æ ¼å¼è¿›è¡Œä¿å­˜å›¾åƒ

#### æ·»åŠ ç”»å¸ƒ

æœ‰äº†ç”»å¸ƒæ‰èƒ½åœ¨å…¶ä¸Šé¢ä½œå›¾ã€‚ä½¿ç”¨D3åœ¨bodyå…ƒç´ ä¸­**æ·»åŠ svgç”»å¸ƒ**çš„ä»£ç å¦‚ä¸‹ï¼š

$\color{red}{æ­¤æ®µä»£ç å¸¸ç”¨ï¼Œé¡»è®°ä½}$

```javascript
// D3ä¸­å®šä¹‰ç”»å¸ƒsvgï¼Œè®¾ç½®å®½é«˜
        const width = 300;
        const height = 300;

        const svg = d3.select("body")  // é€‰æ‹©bodyå…ƒç´ 
                    .append("svg")   // æ·»åŠ svg
                    .attr("width", width)  // è®¾ç½®SVGçš„å®½é«˜
                    .attr("height", height)
```

### ç»˜åˆ¶çŸ©å½¢

#### rect

åœ¨SVGä¸­ï¼ŒçŸ©å½¢çš„å…ƒç´ æ ‡ç­¾æ˜¯rectã€‚**åœ†å½¢çš„å…ƒç´ æ ‡ç­¾æ˜¯circle**

```html
<svg>
  <rect></rect>
  <rect></rect>
  <rect></rect>
</svg>
```

rectçš„å››ä¸ªå±æ€§ï¼š

- xï¼šçŸ©å½¢å·¦ä¸Šè§’xåæ ‡

- yï¼šçŸ©å½¢å·¦ä¸Šè§’çš„yåæ ‡

- widthï¼šå®½åº¦

- heightï¼šé«˜åº¦

éœ€è¦æ³¨æ„çš„ï¼šåœ¨SVGä¸­ï¼Œ**xè½´çš„æ­£æ–¹å‘æ˜¯æ°´å¹³å‘å³ï¼Œyè½´çš„æ­£æ–¹å‘æ˜¯å‚ç›´å‘ä¸‹çš„**

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gesxxeea08j312a0mxacm.jpg)

#### ä»£ç è§£é‡Š

å½“æˆ‘ä»¬å®šä¹‰äº†æ•°ç»„å’Œç”»å¸ƒä¹‹åï¼Œéœ€è¦æ·»åŠ å’Œæ•°ç»„é•¿åº¦ç›¸åŒçš„çŸ©å½¢å…ƒç´ 

```javascript
svg.selectAll("rect")  // ç»˜åˆ¶çŸ©å½¢ä½¿ç”¨rectæ ‡ç­¾
            .data(dataset)   // ç»‘å®šæ•°æ®dataset
            .enter()     // æŒ‡å®šæ•°æ®é›†ä¸­çš„enteréƒ¨åˆ†
            .append("rect")   // æ·»åŠ è¶³å¤Ÿçš„å…ƒç´ ã€‚æœ‰æ•°æ®ä½†æ˜¯æ²¡æœ‰å›¾å½¢å…ƒç´ çš„æ—¶å€™ï¼Œä½¿ç”¨append()è¿›è¡Œè¿½åŠ 
```

å®šä¹‰å®Œæ¯ä¸ªçŸ©å½¢å…ƒç´ ä¹‹åï¼Œä½¿ç”¨æ— åå‡½æ•°å¯¹å…¶è¿›è¡Œå±æ€§çš„èµ‹å€¼ï¼Œä¸»è¦æ˜¯ä¸Šé¢ğŸ‘†æåˆ°çš„4ä¸ªå±æ€§ã€‚åœ¨ä½¿ç”¨`attr`å±æ€§çš„æ—¶å€™ï¼Œé¢œè‰²å¯¹åº”çš„`fill`ã€‚

```javascript
.attr("x", 50)  // å®šä¹‰å·¦ä¸Šè§’çš„åæ ‡x
.attr("y", function(d,i){  // å®šä¹‰å·¦ä¸Šè§’çš„åæ ‡yï¼šdæ˜¯ä½œç”¨çš„æ•°æ®ï¼Œiæ˜¯ç´¢å¼•å·
  return i * rectHeight;
})
.attr("width", function(d){   // è®¾ç½®å®½åº¦
  return d;
})
.attr("height", rectHeight-2)  // è®¾ç½®é•¿åº¦
.attr("fill", "blue");   // è®¾ç½®å±æ€§é¢œè‰²
```

### å®Œæ•´ä»£ç 

ä¸‹é¢é™„ä¸Šå®Œæ•´çš„HTMLä»£ç ï¼Œä¿å­˜ä¹‹åé€šè¿‡æµè§ˆå™¨æ‰“å¼€å³å¯çœ‹åˆ°æ•ˆæœã€‚

```javascript
<!DOCTYPE html>
<html>
<head>
    <title>D3.js tutorial</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>

    <script>

        // å®šä¹‰æ•°æ®ï¼šè¡¨ç¤ºçŸ©å½¢çš„å®½åº¦
         const dataset = [80, 160, 20, 100, 300]
        // å®šä¹‰ç”»å¸ƒçš„è¾¹è·
        const merge = {top:60, bottom:60, left:60,right:60}


        // D3ä¸­å®šä¹‰ç”»å¸ƒsvgï¼Œè®¾ç½®å®½é«˜
        const width = 300;
        const height = 300;

        var svg = d3.select("body")  // é€‰æ‹©bodyå…ƒç´ 
                    .append("svg")   // æ·»åŠ svg
                    .attr("width", width)  // è®¾ç½®SVGçš„å®½é«˜
                    .attr("height", height)

        // ç»˜å›¾ï¼šçŸ©å½¢çš„4ä¸ªå±æ€§ï¼šx/y/width/height
        // å®šä¹‰æ¯ä¸ªçŸ©å½¢å æ®çš„åƒç´ é«˜åº¦
        const rectHeight = 25;

        svg.selectAll("rect")  // ç»˜åˆ¶çŸ©å½¢ä½¿ç”¨rectæ ‡ç­¾
            .data(dataset)   // ç»‘å®šæ•°æ®dataset
            .enter()     // æŒ‡å®šæ•°æ®é›†ä¸­çš„enteréƒ¨åˆ†
            .append("rect")   // æ·»åŠ è¶³å¤Ÿçš„å…ƒç´ ã€‚æœ‰æ•°æ®ä½†æ˜¯æ²¡æœ‰å›¾å½¢å…ƒç´ çš„æ—¶å€™ï¼Œä½¿ç”¨append()è¿›è¡Œè¿½åŠ 
                .attr("x", 50)  // å®šä¹‰å·¦ä¸Šè§’çš„åæ ‡x
                .attr("y", function(d,i){  // å®šä¹‰å·¦ä¸Šè§’çš„åæ ‡yï¼šdæ˜¯ä½œç”¨çš„æ•°æ®ï¼Œiæ˜¯ç´¢å¼•å·
                    return i * rectHeight;
                })
                .attr("width", function(d){   // è®¾ç½®å®½åº¦
                    return d;
                })
                .attr("height", rectHeight-2)  // è®¾ç½®é•¿åº¦
                .attr("fill", "blue");   // è®¾ç½®å±æ€§é¢œè‰²
    </script>
</body>
</html>
```


